/*! jetzt 2021-06-26
* https://ds300.github.io/jetzt/
* Copyright (c) 2021 David Sheldrick and contributors; Licensed Apache 2.0 */

!function(e){void 0!==e.jetzt?console.warn("jetzt unable to initialize, window.jetzt already set"):e.jetzt={}}(this),function(e){var e=e.jetzt,s={};function n(e,t,r){var n=[];0<=e.className.trim().length&&(n=e.className.split(/\s+/)),t.split(/\s+/).forEach(function(e){r(n,e)}),e.className=n.join(" ")}(e.helpers=s).removeFromArray=function(e,t){t=e.indexOf(t);-1<t&&e.splice(t,1)},s.getScrollTop=function(){return document.body.scrollTop||document.documentElement.scrollTop},s.getScrollLeft=function(){return document.body.scrollLeft||document.documentElement.scrollLeft},s.elem=function(e,t,r){var n=document.createElement(e);return n.className=t||"",r&&r.forEach(function(e){n.appendChild(e)}),n},s.div=function(e,t){return s.elem("div",e,t)},s.span=function(e,t){return s.elem("span",e,t)},s.addClass=function(e,t){n(e,t,function(e,t){s.removeFromArray(e,t),e.push(t)})},s.removeClass=function(e,t){n(e,t,s.removeFromArray)},s.hasClass=function(e,t){var r=!0;return n(e,t,function(e,t){r=r&&-1<e.indexOf(t)}),r},s.realTypeOf=function(e){return Object.prototype.toString.call(e).slice(8,-1)},s.flatten=function(e){var r=[];return function e(t){"[object Array]"===Object.prototype.toString.call(t)?t.forEach(e):r.push(t)}(e),r},s.clamp=function(e,t,r){return Math.min(Math.max(t,e),r)},s.recursiveExtend=function(){for(var e=arguments[0],t=1;t<arguments.length;t++){var r,n,o,a=arguments[t];for(r in a)a.hasOwnProperty(r)&&(e.hasOwnProperty(r)?(n=e[r],o=a[r],"Object"===s.realTypeOf(n)&&"Object"===s.realTypeOf(o)?e[r]=s.recursiveExtend({},n,o):e[r]=o):e[r]=a[r])}return e},s.keys=function(e){var t,r=[];for(t in e)e.hasOwnProperty(t)&&r.push(t);return r},s.clone=function(e){return JSON.parse(JSON.stringify(e))}}(this),function(n){var e=n.jetzt,a=e.helpers,o=[{name:"Classic",dark:{backdrop_opacity:"0.86",colors:{backdrop:"#000000",background:"#303030",foreground:"#E0E0E0",message:"#909090",pivot:"#73b5ee",progress_bar_background:"#000000",progress_bar_foreground:"#3a5566",reticle:"#656565",wrap_background:"#404040",wrap_foreground:"#a1a1a1"}},light:{backdrop_opacity:"0.07",colors:{backdrop:"black",background:"#fbfbfb",foreground:"#333333",message:"#929292",pivot:"#E01000",progress_bar_background:"black",progress_bar_foreground:"#00c00a",reticle:"#efefef",wrap_background:"#f1f1f1",wrap_foreground:"#666"}}}],t={config_version:0,target_wpm:400,scale:1,dark:!1,selected_theme:0,show_message:!1,strip_citation:!1,selection_color:"#FF0000",modifiers:{normal:1,start_clause:1,end_clause:1.8,start_sentence:1.3,end_sentence:2.2,start_paragraph:2,end_paragraph:2.8,short_space:1.5,long_space:2.2},font_family:"Menlo, Monaco, Consolas, monospace",font_weight:"normal",custom_themes:[]},s=a.clone(t),r=[];function i(){r.forEach(function(e){e()})}var c="jetzt_options",l={get:function(e){var t=localStorage.getItem(c);e(t&&"{}")},set:function(e){localStorage.setItem(c,e)}};function u(){l.set(JSON.stringify(s))}function f(e,t){if("string"==typeof e&&(e=[e]),1===arguments.length)return function e(t,r){if(0===r.length)throw new Error("No keys specified.");var n=r[0];if(1===r.length)return t.hasOwnProperty(n)||console.warn("config lookup: no key '"+n+"'"),t[n];t=t[n];if("Object"===a.realTypeOf(t))return e(t,r.slice(1));console.warn("config lookup: no key '"+n+"'")}(s,e);!function(e,t,r){if(0===t.length)throw new Error("No keys specified.");var n,o=t[0];1===t.length?e[o]=r:(n=e[o],"Object"!==a.realTypeOf(n)&&(e[o]=n={}),_put(n,t.slice(1),r))}(s,e,t),u(),i()}(e.config=f).DEFAULTS=a.clone(t),f.DEFAULT_THEMES=a.clone(o),f.onChange=function(e){return r.push(e),function(){a.removeFromArray(r,e)}},f.setBackend=function(e){l=e,this.refresh(),i()},f.refresh=function(t){l.get(function(e){!function(e){try{var r=JSON.parse(e||"{}"),t=!1;0!=r.config_version&&(r.custom_themes&&a.keys(r.custom_themes).forEach(function(e){var t=r.custom_themes[e];r.custom_themes[e]=a.recursiveExtend(o.Classic,t)}),t=!(r.config_version=0)),a.recursiveExtend(s,r),n.jazz=s,t&&u(),i()}catch(e){throw new Error("corrupt config json",e)}}(e),t&&t()})},f.getSelectedTheme=function(){return o[s.selected_theme]||o[0]},f.maxModifier=function(e,t){return this(["modifiers",e])>this(["modifiers",t])?e:t},f.adjustWPM=function(e){s.target_wpm=a.clamp(100,s.target_wpm+e,1500),i(),u()},f.adjustScale=function(e){this("scale",a.clamp(0,s.scale+e,1))},f.save=function(){u()},f.refresh()}(this),function(s){var e=s.jetzt,i=e.helpers,c=e.config;function l(e){return 13<e.length||9<e.length&&-1<e.indexOf("-")}function u(e){if(l(e)){var t=[],r=e.indexOf("-");if(0<r&&r<e.length-1)return t.push(e.substr(0,r)),t.push(e.substr(r+1)),i.flatten(t.map(u));for(var n=Math.ceil(e.length/8),o=Math.ceil(e.length/n);n--;)t.push(e.substr(0,o)),e=e.substr(o);return t}return[e]}var f=new RegExp("\\s?(\\(((((((\\S\\.\\s)?(\\S+\\s)?\\S+?),\\s)*((\\S\\.\\s)?(\\S+\\s)?\\S+?),?\\s(and|&)\\s)?((\\S\\.\\s)?(\\S+\\s)?\\S+?)(,?\\set\\sal\\.?)|(((((\\S\\.\\s)?(\\S+\\s)?\\S+?),\\s)*((\\S\\.\\s)?(\\S+\\s)?\\S+?),?\\s(and|&)\\s)?((\\S\\.\\s)?(\\S+\\s)?\\S+?)(,?\\set\\sal\\.?)?,?\\s)?(((16|17|18|19|20)\\d{2}[a-z]?)|([a-z]{1,4}\\.\\s\\d+))((,\\s|:)(([a-z]{1,4}\\.\\s\\d+)|\\d+))*)(;|,|,?\\s(and|&))\\s)*(((((\\S\\.\\s)?(\\S+\\s)?\\S+?),\\s)*((\\S\\.\\s)?(\\S+\\s)?\\S+?),?\\s(and|&)\\s)?((\\S\\.\\s)?(\\S+\\s)?\\S+?)(,?\\set\\sal\\.?)|(((((\\S\\.\\s)?(\\S+\\s)?\\S+?),\\s)*((\\S\\.\\s)?(\\S+\\s)?\\S+?),?\\s(and|&)\\s)?((\\S\\.\\s)?(\\S+\\s)?\\S+?)(,?\\set\\sal\\.?)?,?\\s)?(((16|17|18|19|20)\\d{2}[a-z]?)|([a-z]{1,4}\\.\\s\\d+))((,\\s|:)(([a-z]{1,4}\\.\\s\\d+)|\\d+))*)\\)|\\[\\d+\\])","g");function d(){var r=[],n="normal",t=[],o=null;this.modNext=function(e){n=c.maxModifier(n,e)},this.modPrev=function(e){var t;0<r.length&&(t=r[r.length-1].modifier,r[r.length-1].modifier=c.maxModifier(t,e))},this.decPrev=function(e){0<r.length&&(r[r.length-1].decorator,r[r.length-1].decorator+=e)},this.pushWrap=function(e){t.push(e)},this.popWrap=function(e){-1<t.lastIndexOf(e)&&t.splice(t.lastIndexOf(e),t.length)},this.clearWrap=function(e){t=[]};function a(e){return e.leftWrap=t.map(function(e){return e.left}).join(""),e.rightWrap=t.map(function(e){return e.right}).reverse().join(""),e}this.spacer=function(){o?o.modifier="long_space":o=a({token:"   ",modifier:"short_space",decorator:""})},this.token=function(e){o&&r.push(o);var t=l(e)?u(e):[e],e=t.pop();t.forEach(function(e){r.push(a({token:e,modifier:"normal",decorator:"-"}))}),r.push(a({token:e,modifier:n,decorator:""})),n="normal",o=null},this.getInstructions=function(){return r}}var h={guillemot:{left:"«",right:"»"},double_quote:{left:"“",right:"”"},parens:{left:"(",right:")"},heading:{left:"#",right:""},blockquote:{left:"›",right:""}};function p(e,t){var r=t||new d,n=null;if("Array"===i.realTypeOf(e))n=e;else{n=e.childNodes;if([].reduce.call(n,function(e,t){return e&&(1!==t.nodeType||!!s.getComputedStyle(t).display.match(/^inline/))},!0)){e=e.textContent.trim();return 0<e.length&&g(e,r),r.getInstructions()}}for(var o=null,a=0;a<n.length;a++)switch((o=n[a]).nodeName){case"H1":case"H2":case"H3":case"H4":case"H5":case"H6":r.clearWrap(),r.pushWrap(h.heading),r.modNext("start_paragraph"),p(o,r),r.spacer(),r.popWrap(h.heading),r.modPrev("end_paragraph");break;case"BLOCKQUOTE":r.pushWrap(h.blockquote),r.modNext("start_paragraph"),p(o,r),r.popWrap(h.blockquote),r.modPrev("end_paragraph");break;case"SCRIPT":break;case"#text":0<o.textContent.trim().length&&g(o.textContent.trim(),r);break;case"DL":case"OL":case"UL":case"SECTION":case"P":r.modNext("start_paragraph"),p(o,r),r.modPrev("end_paragraph");break;case"#comment":break;default:p(o,r)}return r.getInstructions()}function g(e,t){var r=(e=c("strip_citation")?e.replace(f,""):e).match(/["«»“”\(\)\/–—]|--+|\n+|[^\s"“«»”\(\)\/–—]+/g);null===r&&(r=[]);for(var n=t||new d,o=!1,a=0;a<r.length;a++){var s=r[a];switch(s){case"“":n.spacer(),n.pushWrap(h.double_quote),n.modNext("start_clause");break;case"”":n.popWrap(h.double_quote),n.modPrev("end_clause"),n.spacer();break;case"«":n.spacer(),n.pushWrap(h.guillemot),n.modNext("start_clause");break;case"»":n.popWrap(h.guillemot),n.modPrev("end_clause"),n.spacer();break;case'"':o?(n.popWrap(h.double_quote),n.spacer(),n.modNext("start_clause")):(n.spacer(),n.pushWrap(h.double_quote),n.modPrev("end_clause")),o=!o;break;case"(":n.spacer(),n.pushWrap(h.parens),n.modNext("start_clause");break;case")":n.popWrap(h.parens),n.modPrev("end_clause"),n.spacer();break;default:s.match(/^(\/|--+|—|–)$/)?(n.modNext("start_clause"),n.token(s),n.modNext("start_clause")):s.match(/^[.?!…]+$/)?(n.decPrev(s),n.modPrev("end_sentence")):s.match(/[.?!…]+$/)?(n.modNext("end_sentence"),n.token(s),n.modNext("start_sentence")):s.match(/^[,;:]$/)?(n.decPrev(s),n.modPrev("end_clause")):s.match(/[,;:]$/)?(n.modNext("end_clause"),n.token(s),n.modNext("start_clause")):s.match(/\n+/)?(1<s.length||0<a&&r[a-1].match(/[.?!…'"”]+$/))&&(n.clearWrap(),n.modPrev("end_paragraph"),n.spacer(),n.modNext("start_paragraph"),o=!1):s.match(/^".+$/)?(o=!0,n.modNext("start_clause"),n.token(s.substr(1))):n.token(s)}}return n.getInstructions()}function t(e,t){var r=new d;return e(t,r),r.getInstructions()}e.parse={string:function(e){return t(g,e)},dom:function(e){return t(p,e)}}}(this),function(e){var l=e.jetzt,u=l.config;var f={start_sentence:!0,start_paragraph:!0};function t(n){var t,o=l.view.reader,r=!1,a=0;function s(e){var t,r;void 0===e&&(e=a<n.length?n[a]:n[n.length-1]),o.setWord(e.token,e.decorator),o.setWrap(e.leftWrap,e.rightWrap),o.setProgress(a/n.length*100),1===a?(r=Math.round((new Date).getTime()/1e3),o.started=r):a===n.length?(r=n.length,t=Math.round((new Date).getTime()/1e3)-o.started,o.setMessage(r+" words in "+t+"s")):a%5==0&&(t=n.length,t=(Math.round((new Date).getTime()/1e3)-o.started)*(t-a)/a,o.setMessage(Math.round(t)+"s left"))}function i(e){s(e),c(function(e){var t=6e4/u("target_wpm");if("normal"!==e.modifier)return t*u(["modifiers",e.modifier]);var r=1;switch(e.token.length){case 6:case 7:r=1.2;break;case 8:case 9:r=1.4;break;case 10:case 11:r=1.8;break;case 12:case 13:r=2}return t*r}(e))}function c(e){t=setTimeout(function(){r&&a<n.length?i(n[a++]):r=!1},e)}this.start=function(){a===n.length&&(a=0),r=!0,c(0)},this.stop=function(){clearTimeout(t),r=!1},this.toggleRunning=function(e){e!==r&&(r?this.stop():this.start())},this.prevSentence=function(){for(a=Math.max(0,a-5);0<a&&!f[n[a].modifier];)a--;r||s()},this.nextSentence=function(){for(a=Math.min(a+1,n.length-1);a<n.length-1&&!f[n[a].modifier];)a++;r||s()},this.prevParagraph=function(){for(a=Math.max(0,a-5);0<a&&"start_paragraph"!=n[a].modifier;)a--;r||s()},this.nextParagraph=function(){for(a=Math.min(a+1,n.length-1);a<n.length-1&&"start_paragraph"!=n[a].modifier;)a++;r||s()}}l.exec=function(e){return new t(e)}}(this),function(v){var e,t=v.jetzt,_=t.config,k=t.helpers,b=k.div,w=k.span,r={};function n(){var t,r=b("sr-backdrop"),n=b("sr-wpm"),o=b("sr-wrap sr-left"),a=b("sr-wrap sr-right"),s=w(),i=w(),c=w("sr-pivot"),l=w("sr-decorator"),u=b("sr-word",[s,c,i,l]),f=b("sr-progress"),d=b("sr-message"),h=b("sr-reticle"),p=b("sr-word-box",[h,f,d,u,n]),g=b("sr-reader",[o,p,a]),m=b("sr-reader-wrapper",[g]);g.onkeyup=g.onkeypress=function(e){if(!e.ctrlKey&&!e.metaKey)return e.stopImmediatePropagation(),!1};function y(){g.tabIndex=0,g.focus()}this.onBackdropClick=function(e){r.onclick=e},this.onKeyDown=function(e){g.onkeydown=e},this.dark=!1,this.applyConfig=function(){this.dark=_("dark"),this.applyTheme(_.getSelectedTheme()),this.setScale(_("scale")),this.setWPM(_("target_wpm")),this.setFont(_("font_family")),this.setFontWeight(_("font_weight")),_("show_message")?this.showMessage():this.hideMessage()},this.appendTo=function(e){e.appendChild(r),e.appendChild(m),m.offsetWidth,k.addClass(m,"in")},this.watchConfig=function(){var e=this;t=_.onChange(function(){e.applyConfig()})},this.unwatchConfig=function(){t&&t()},this.show=function(e){this.appendTo(document.body),this.applyConfig(),this.watchConfig();var t=k.getScrollTop();y(),document.body.scrollTop=t,document.documentElement.scrollTop=t,g.onblur=y,v.onfocus=function(){setTimeout(y,100)},"function"==typeof e&&v.setTimeout(e,340)},this.hide=function(e){t(),g.onblur=null,g.blur(),r.style.opacity=0,k.removeClass(m,"in"),v.setTimeout(function(){r.remove(),m.remove(),"function"==typeof e&&e()},340)},this.setScale=function(e){m.style.webkitTransform="translate(-50%, -50%) scale("+e+")",m.style.mozTransform="translate(-50%, -50%) scale("+e+")",m.style.transform="translate(-50%, -50%) scale("+e+")"},this.setWPM=function(e){n.innerHTML=e+""},this.setFont=function(e){s.style.fontFamily=e,c.style.fontFamily=e,i.style.fontFamily=e,l.style.fontFamily=e,o.style.fontFamily=e,a.style.fontFamily=e,n.style.fontFamily=e,d.style.fontFamily=e},this.toggleMirror=function(e){var t="sr-mirrored";((e=void 0===e?!k.hasClass(g,t):e)?k.addClass:k.removeClass).bind(k)(g,t)},this.setFontWeight=function(e){s.style.fontWeight=e,c.style.fontWeight=e,i.style.fontWeight=e,l.style.fontWeight=e},this.applyTheme=function(e){var t=this.dark?e.dark:e.light,e=t.colors;r.offsetWidth,r.style.opacity=t.backdrop_opacity,r.style.backgroundColor=e.backdrop,p.style.backgroundColor=e.background,s.style.color=e.foreground,i.style.color=e.foreground,o.style.backgroundColor=e.wrap_background,a.style.backgroundColor=e.wrap_background,o.style.color=e.wrap_foreground,a.style.color=e.wrap_foreground,h.style.borderColor=e.reticle,c.style.color=e.pivot,l.style.color=e.message,f.style.borderColor=e.progress_bar_foreground,f.style.backgroundColor=e.progress_bar_background,d.style.color=e.message,n.style.color=e.message},this.setProgress=function(e){f.style.borderLeftWidth=Math.ceil(4*e)+"px"},this.setMessage=function(e){d.innerHTML=e},this.showMessage=function(){d.style.display="block"},this.hideMessage=function(){d.style.display="none"},this.started=!1,this.setWord=function(e,t){var r,r=(r=(r=e.replace(/[?.,!:;*-]+$/,"")).length)<2?0:r<6?1:r<10?2:r<14?3:4;s.innerHTML=e.substr(0,r),c.innerHTML=e.substr(r,1),i.innerHTML=e.substr(1+r),void 0!==t&&(l.innerHTML=t),u.offsetWidth;t=h.offsetLeft+h.offsetWidth/2;u.style.left=t-c.offsetLeft-c.offsetWidth/2+"px"},this.setWrap=function(e,t){o.innerHTML=e,a.innerHTML=t;e=o.offsetWidth,t=a.offsetWidth;m.style.paddingLeft="50px",m.style.paddingRight="50px",t<e?m.style.paddingRight=e-t+50+"px":e<t&&(m.style.paddingLeft=t-e+50+"px")},this.clear=function(){this.setWrap("",""),this.setWord("   ","")}}(t.view=r).Reader=n,r.__defineGetter__("reader",function(){return e=e||new n});var o=[];r.addOverlay=function(e){var t=e.getBoundingClientRect(),r=k.div("sr-overlay");return r.style.top=k.getScrollTop()+t.top+"px",r.style.left=k.getScrollLeft()+t.left+"px",r.style.width=t.width+"px",r.style.height=t.height+"px",r.style.backgroundColor=_("selection_color"),document.body.appendChild(r),e.___jetztOverlay=r,o.push(e),t.top<v.innerHeight},r.removeOverlay=function(e){e.___jetztOverlay&&(e.___jetztOverlay.remove(),delete e.___jetztOverlay,k.removeFromArray(o,e))},r.removeAllOverlays=function(){for(var e=o.length;e--;){var t=o[e];t.___jetztOverlay.remove(),delete t.___jetztOverlay}o=[]},r.highlightRange=function(e){}}(this),function(r){var d=r.jetzt,h=d.helpers;function p(e,t){r.addEventListener(e,t)}function g(e,t){r.removeEventListener(e,t)}function t(){function t(e){d.view.removeAllOverlays(),o=e,function(){overlays=[];for(var e=0,t=o.length;e<t&&d.view.addOverlay(o[e]);e++);}()}function r(e){for(var t=e,r=e.parentNode;r&&!c[r.tagName];)r=(t=r).parentNode;if(r){for(var n=r.childNodes,o=n.length,a=[],s=0;n[s]!==t;)s++;for(;s<o;s++){var i=n[s];l[i.tagName]&&a.push(i)}return a}return[e]}function n(){d.view.removeAllOverlays(),g("mouseover",s),g("mousemove",i),g("keydown",u),g("keyup",f),g("click",e),a&&h.removeClass(a,"sr-pointer")}var o=[],a=null,c={DIV:!0,ARTICLE:!0,BLOCKQUOTE:!0,MAIN:!0,SECTION:!0,UL:!0,OL:!0,DL:!0},l={P:!0,H1:!0,H2:!0,H3:!0,H4:!0,H5:!0,H6:!0,SPAN:!0,DL:!0,OL:!0,UL:!0,BLOCKQUOTE:!0,SECTION:!0},s=function(e){a&&h.removeClass(a,"sr-pointer"),h.addClass(e.target,"sr-pointer"),a=e.target,e.altKey?t([e.target]):t(r(e.target))},e=function(e){n(),d.init(d.parse.dom(o))},i=function(e){s(e),g("mousemove",i)},u=function(e){27===e.keyCode?n():e.altKey&&1<o.length&&t([o[0]])},f=function(e){e.altKey||1!==o.length||t(r(o[0]))};p("mouseover",s),p("click",e),p("mousemove",i),p("keydown",u),p("keyup",f)}d.select=function(e){e=void 0===e?r.getSelection().toString():e.selectionText;0<e.trim().length?(d.init(d.parse.string(e)),r.getSelection().removeAllRanges()):t()}}(this),function(e){var r=e.jetzt,n=(r.helpers,r.config),t={};function o(e){e.preventDefault(),e.stopImmediatePropagation()}(r.control=t).keyboard=function(t){r.view.reader.onKeyDown(function(e){if(!e.ctrlKey&&!e.metaKey)switch(e.keyCode){case 27:o(e),r.quit();break;case 38:o(e),n.adjustWPM(10);break;case 40:o(e),n.adjustWPM(-10);break;case 37:o(e),e.altKey?t.prevParagraph():t.prevSentence();break;case 39:o(e),e.altKey?t.nextParagraph():t.nextSentence();break;case 32:o(e),t.toggleRunning();break;case 187:case 107:case 61:o(e),n.adjustScale(.1);break;case 109:case 189:case 173:o(e),n.adjustScale(-.1);break;case 48:o(e),n("dark",!n("dark"));break;case 191:o(e),n("show_message",!n("show_message"));break;case 8:o(e),r.view.reader.toggleMirror()}})},e.addEventListener("keydown",function(e){!r.isOpen()&&e.altKey&&83===e.keyCode&&(e.preventDefault(),r.select())})}(this),function(e){var t,r=e.jetzt,n=r.view.reader;r.init=function(e){if(t)throw new Error("jetzt already initialised");n.clear(),t=r.exec(e),r.control.keyboard(t),n.show(),n.onBackdropClick(r.quit),setTimeout(function(){t.start()},500)},r.quit=function(){t.stop(),n.hide(),t=null},r.isOpen=function(){return!!t}}(this);